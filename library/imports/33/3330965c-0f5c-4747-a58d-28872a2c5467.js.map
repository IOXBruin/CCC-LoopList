{"version":3,"sources":["assets/looplist/Touchable.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n/// 点击间隔\r\nconst click_interval: number = 1\r\n\r\n@ccclass\r\nexport default class Touchable extends cc.Component{\r\n    @property( cc.Boolean)\r\n    public interactable: boolean = true\r\n\r\n    @property( cc.AudioClip)\r\n    public audioClip: cc.AudioClip = null\r\n\r\n    public clicked: ()=>void = null\r\n\r\n    // private mark: number = 0\r\n\r\n    onEnable(){\r\n        this._registerNodeEvent()\r\n    }\r\n\r\n    onDisable(){\r\n        this._unregisterNodeEvent()\r\n    }\r\n    \r\n    /// on node event\r\n    _registerNodeEvent () {\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this);\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMove, this);\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this);\r\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);\r\n    }\r\n    \r\n    _unregisterNodeEvent () {\r\n        this.node.off(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this);\r\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMove, this);\r\n        this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this);\r\n        this.node.off(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);\r\n    }\r\n\r\n    private _pressed: boolean = false\r\n    // touch event handler\r\n    _onTouchBegan (event) {\r\n        if (!this.interactable || !this.enabledInHierarchy) return;\r\n        this._pressed = true;\r\n        event.stopPropagation();\r\n        /// play audio clip\r\n        if( this.audioClip) { cc.audioEngine.play( this.audioClip, false, 1) }\r\n    }\r\n\r\n    _onTouchMove (event) {\r\n        if (!this.interactable || !this.enabledInHierarchy || !this._pressed) return;\r\n        event.stopPropagation();\r\n    }\r\n\r\n    _onTouchEnded (event) {\r\n        if (!this.interactable || !this.enabledInHierarchy) return;\r\n        this._pressed = false;\r\n        event.stopPropagation();\r\n        if( this.clicked) { this.clicked()}\r\n    }\r\n\r\n    _onTouchCancel () {\r\n        if (!this.interactable || !this.enabledInHierarchy) return;\r\n        this._pressed = false;\r\n    }\r\n}"]}